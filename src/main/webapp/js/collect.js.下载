/*! 2019-12-04_13:15:49 sem.am@ctrip.com */
!function(t){if(t=t||{isServer:!0},!t.isServer)try{var e="1.0.0",i={getCookie:function(t){if(!t)return document.cookie;if(document.cookie.indexOf(t+"=")==-1)return null;for(var e=document.cookie.split(/\s*\;\s*/g),i=0;i<e.length;i++){var o=e[i].split("=");if(o[0]==t)return unescape(o[1])}return null},getStorage:function(e){return t.localStorage&&t.localStorage.getItem(e)||null},getExpires:function(t){var e=new Date;return e.setDate(e.getDate()+t),e.toGMTString()},getUaTag:function(){return t.navigator.userAgent},setCookie:function(t){var e=[];if(t.key){e=[t.key+"="+t.value];for(var i in t)["key","value"].indexOf(i)>-1||e.push(i+"="+t[i]);document.cookie=e.join(";")}},setStorage:function(e,i){t.localStorage.setItem(e,i)},track:function(e,i){t.__bfi&&t.__bfi.push(["_tracklog",e,JSON.stringify(i)])}},o=function(){this.ubtKey="106417",this.temps=["x.yyyyy.zzzz"],this.key="MKT_CKID",this.expiresDays=999999,this.domain=t.location.hostname.split(".").slice(-2).join(".")||"ctrip.com",this.ckid=null,this.asyncCookieTicket(),this.sendProductInfo()};o.prototype={getProductInfo:function(){var t={mktckid:this.ckid,pagetitle:document.title,version:e},i=this.splitBuUrl();for(var o in i)t[o]=i[o];return t},splitBuUrl:function(t,e){for(var i=location.href,o="HOME",r="LIST",c="DETAIL",n="from",a="to",s="productid",u={},l=[["DHTL",c,/\/\/hotels\.ctrip\.com\/hotel\/(\d+)\.html/,[s]],["DHTL",r,/\/\/hotels\.ctrip\.com\/hotel\/(?:\D+?)(\d+?)(?:[\?\#]{1}[\S]*|[.]{0})$/,[a]],["IHTL",c,/\/\/hotels\.ctrip\.com\/international\/([^\/]+?)\.html/,[s]],["DFLT",r,/\/\/flights\.ctrip\.com\/booking\/([^\-]+?)\-([^\-]+?)(?:[.]{0}|\-[\S]*)\.html/,[n,a]],["DFLT",r,/\/\/flights\.ctrip\.com\/itinerary\/(?:oneway|roundtrip)\/([^\-]+?)\-([^\-]+?)(?:[\?\#]{1}[\S]*|[.]{0})$/,[n,a]],["IFLT",r,/\/\/flights\.ctrip\.com\/international\/[^\-]+\-[^\-]+\-([^\-]+?)\-([^\-]+?)(?:[\?\#]{1}[\S]*|[.]{0})$/,[n,a]],["IFLT",r,/\/\/flights\.ctrip\.com\/international\/FlightResult\.aspx\?.*DCity\=(.+?)\&.*ACity\=(.+?)(?:$|\&.*$)/,[n,a]],["IFLT",r,/\/\/flights\.ctrip\.com\/international\/search\/[^\-]*\-(.+?)\-(.+?)(?:($|(\?.*$)))/,[n,a]],["TTD",c,/\/\/piao\.ctrip\.com\/ticket\/dest\/([^\/]+?)\.html/,[s]],["TTD",r,/\/\/piao\.ctrip\.com\/dest\/([^\/]+?)\/s\-tickets/,[a]],["TTD",o,/\/\/piao\.ctrip\.com.{0,1}/],["CRU",c,/\/\/cruise\.ctrip\.com\/c\/(.+?).html/,[s]],["CRU",r,/\/\/cruise\.ctrip\.com\/search\/(.+?).html/,[s]],["CRU",o,/\/\/cruise\.ctrip\.com($|\/$)/],["TRN",r,/\/\/trains\.ctrip\.com\/TrainBooking\/(?:Search|RoundTrip|HubRoundTrip)\.aspx\?(?:from=|.*&from=)([^\&]+).*(?:&to=)([^\&]+)/,[n,a]],["VAC",c,/\/\/vacations\.ctrip\.com\/tour\/detail(?:.{0}|\/grouptravel)\/([^\/]+?)\.html/,[s]],["VAC",o,/\/\/vacations\.ctrip\.com($|\/$)/],["DIY",o,/\/\/vacations\.ctrip\.com\/idiytour($|\/$)/],["PKG",o,/\/\/vacations\.ctrip\.com\/grouptravel($|\/$)/],["VIS",c,/\/\/vacations\.ctrip\.com\/visa\/([^\/]+?).html/,[s]],["VIS",r,/\/\/vacations\.ctrip\.com\/visa\/searchlist\?poid\=([^\&]*)/,[s]],["VIS",o,/\/\/vacations\.ctrip\.com\/visa(?:[\?\#]{1}[\S]*|.{0})$/],["GS",r,/\/\/you\.ctrip\.com\/(?:place|travels)\/(?:\D*)(\d+?)\.html/,[a]],["GS",o,/\/\/you\.ctrip\.com($|\/$)/]],p=0;p<l.length;p++){var h=l[p],m=h[2]&&h[2].exec(i.replace(/\/\?|\/$/,""));if(m){u.bu=h[0],u.pagetype=h[1],h[3]&&h[3].map(function(t,e){u[t]=m[e+1]});break}}return t===!0&&e&&e.map(function(t,e){for(var e=0;e<l.length;e++){var i=l[e],o=i[2]&&i[2].exec(t.replace(/\/\?|\/$/,""));if(o){console.log(i[0],i[1],i[3]?i[3].map(function(t,e){return[t,o[e+1]].join(": ")}):"");break}}}),u},createCKID:function(){var t=this.temps[this.temps.length-1],e=(new Date).getTime();return t.replace(/[xyz]/g,function(t){var i=Math.random();switch(t){case"x":return e;case"y":case"z":return(e+i*Math.pow(10,e.toString().length)).toString(36).substr(1,1)}})},checkCKID:function(t){for(var e=0;e<this.temps.length;e++){var i=this.temps[e].replace(/[^a-zA-Z0-9]/g,function(t){return"\\"+t}).replace(/x/g,"\\d+").replace(/[yz]/g,"[a-z0-9]{1}");if(new RegExp(i).test(t))return!0}return!1},asyncCookieTicket:function(){var t=i.getCookie(this.key)||i.getStorage(this.key);t&&this.checkCKID(t)||(t=this.createCKID()),this.ckid=t,i.setStorage(this.key,t),i.setCookie({key:this.key,value:t,expires:i.getExpires(this.expiresDays),domain:this.domain,path:"/"})},sendProductInfo:function(){var t=this.getProductInfo();t.bu&&i.track(this.ubtKey,t)},watch:function(){}},new o}catch(r){console.log("[mkt-ckid-error] "+r)}}(window);